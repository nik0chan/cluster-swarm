    1  curl https://get.docker.com|bash 
    2  docker swarm init
    3  clear
    4  docker node ps 
    5  docker node ls 
    6  apt install -y nfs-client && mkdir /srv/docker && echo '10.164.0.2:/srv/nfs   /srv/docker   nfs   defaults,_netdev,soft,intr   0    0' >> /etc/fstab
    7  mount -a 
    8  df -h 
    9  cd /srv/docker/
   10  mkdir stacks 
   11  mkdir traefik 
   12  cd stack 
   13  cd stacks/
   14  vi stack.yaml
   15  cd ..
   16  docker network create --drive overlay proxy 
   17  docker network create --driver overlay proxy 
   18  ls 
   19  mv traefik/ stacks/
   20   docker stack deploy -c stacks/stack.yaml 
   21   docker stack deploy -c stacks/stack.yaml traefik 
   22  mv stacks/stack.yaml stacks/traefik/
   23  mkdir stacks/portainer 
   24  nano stacks/portainer/stack.yaml 
   25  apt -get install -y git 
   26  apt-get install git -y 
   27  cd /tmp 
   28  git clone https://github.com/kpeiruza/docker-stacks
   29  ls -l 
   30  cd docker-stacks/
   31  ls -l 
   32  mv portainer /srv/docker/stacks/
   33  cd /srv/docker/stacks/
   34  ls -l 
   35  ls portainer/
   36   docker stack deploy -c portainer/stack.yaml portainer
   37  ls -l 
   38  cd portainer/
   39  ls -l 
   40  nano stack.yaml 
   41  ifconfig 
   42  cd ..
   43  mkdir comptador 
   44  ls -l 
   45  cd ..
   46  ls -l 
   47  cd /
   48  cd /tmp
   49  ls -l 
   50  cd docker-stacks/
   51  ls -l 
   52  mv consul-cluster /srv/docker/stacks/
   53  mv elasticsearch/ /srv/docker/stacks/ 
   54  mv graylog /srv/docker/stacks/ 
   55  mv logspout-elk/ /srv/docker/stacks/
   56   mv redis/ /srv/docker/stacks/
   57  ll 
   58  ls -l 
   59  mv tig-stack/ /srv/docker/stacks/ 
   60  ls -l 
   61  cd /srv/docker/
   62  ls -l 
   63  cd stacks/
   64  sl -l 
   65  ls -l 
   66  docker services
   67  docker services ls 
   68  docker service ls 
   69  systemctl status firewalld 
   70  cd portainer/
   71  ls -l 
   72  nano stack.yaml 
   73  mkdir /srv/docker/portainer
   74  nano stack.yaml 
   75  ifconfig 
   76  ls -l 
   77  nano stack.yaml 
   78  history | grep docker 
   79  docker stack deploy -c stack.yaml 
   80  docker stack deploy -c stack.yaml  portainer
   81  cat stack.yaml  
   82  docker network create portainer_agent 
   83  docker stack deploy -c stack.yaml  portainer
   84  lclear 
   85  clear
   86  docker stack deploy -c stack.yaml  portainer
   87  nano stack.yaml 
   88  nano stack.yaml 
   89  history 
   90  docker network ls 
   91  docker network rm 30467c90f0e6
   92  docker network create portainer_agent -d overlay 
   93  docker stack deploy -c stack.yaml  portainer
   94  vi stack.yaml  
   95  ifconfig
   96  vi stack.yaml  
   97  docker stack deploy -c stack.yaml  portainer
   98  vi stack.yaml  
   99  docker stack deploy -c stack.yaml  portainer
  100  cd ..
  101  cd traefik/
  102  ls -l 
  103  vi stack.yaml 
  104  docker service ps traefik_traefik
  105  docker node 
  106  docker node ls 
  107  docker node promode 
  108  docker node promode 0uoqxpcvbzqiec9nv3mqinz9m ruol7g1qgrptf6m3u9wcx88x4
  109  docker node promote 0uoqxpcvbzqiec9nv3mqinz9m ruol7g1qgrptf6m3u9wcx88x4
  110  docker node ls 
  111  docker node ls 
  112  docker node ls 
  113  docker node ls 
  114  docker node ls 
  115  docker node promote ruol7g1qgrptf6m3u9wcx88x4
  116  docker node ls 
  117  vi stack.yaml 
  118  vim stack.yaml 
  119  docker service ls 
  120  docker service ps portainer_portainer 
  121  docker service ps portainer_portainer --no-truck
  122  docker service ps portainer_portainer --no-trunk
  123  docker service ps portainer_portainer --notrunk
  124  docker service ps portainer_portainer -no-trunk
  125  docker service ps portainer_portainer --no-trunk
  126  docker service ps portainer_portainer -h
  127  docker service ps portainer_portainer --no-trunc
  128  ls -l 
  129  nano stack.yaml 
  130  cd ..
  131  mkdir -p /srv/docker/portainer/data 
  132  cd 
  133  docker service ps portainer_portainer --no-trunc
  134  mount 
  135  df -h 
  136  cd /srv/docker/
  137  ls -l 
  138  cd portainer/
  139  ls -l 
  140  cd data
  141  ls -l 
  142  cd ..
  143  cd ..
  144  cd /
  145  ls -l 
  146  cd /srv/
  147  ls -l 
  148  cd docker/
  149  ls -l 
  150  cd stacks/
  151  ls -l 
  152  cd portainer/
  153  cat stack.yaml 
  154      volumes:
  155        - /var/run/docker.sock:/var/run/docker.sock
  156        - /srv/docker/portainer/data:/data
  157      deploy:
  158        mode: replicated
  159        replicas: 1
  160        labels:
  161          traefik.port: 9000
  162          traefik.frontend.rule: "Host: portainer.35.228.9.131.nip.io"
  163          traefik.docker.network: 'proxy'
  164        placement:
  165          constraints: [node.role == manager]
  166      
  167    agent:
  168      image: portainer/agent
  169      environment:
  170        AGENT_CLUSTER_ADDR: tasks.agent
  171      volumes:
  172        - /var/run/docker.sock:/var/run/docker.sock
  173      ports:
  174        - target: 9001
  175          published: 9001
  176          protocol: tcp
  177          mode: host
  178      networks:
  179        - portainer_agent
  180      deploy:
  181        mode: global
  182        placement:
  183          constraints: [node.platform.os == linux]
  184  networks:
  185    portainer_agent:
  186      external: true
  187    proxy:
  188      volumes:
  189        - /var/run/docker.sock:/var/run/docker.sock
  190        - /srv/docker/portainer/data:/data
  191      deploy:
  192        mode: replicated
  193        replicas: 1
  194        labels:
  195          traefik.port: 9000
  196          traefik.frontend.rule: "Host: portainer.35.228.9.131.nip.io"
  197          traefik.docker.network: 'proxy'
  198        placement:
  199          constraints: [node.role == manager]
  200      
  201    agent:
  202      image: portainer/agent
  203      environment:
  204        AGENT_CLUSTER_ADDR: tasks.agent
  205      volumes:
  206        - /var/run/docker.sock:/var/run/docker.sock
  207      ports:
  208        - target: 9001
  209          published: 9001
  210          protocol: tcp
  211          mode: host
  212      networks:
  213        - portainer_agent
  214      deploy:
  215        mode: global
  216        placement:
  217          constraints: [node.platform.os == linux]
  218  networks:
  219    portainer_agent:
  220      external: true
  221    proxy:
  222      external: true
  223  cler
  224  vi stack.yaml 
  225  cd ..
  226  ls -l 
  227  cd traefik/
  228  ls -l 
  229  vi stack.yaml 
  230  cd ..
  231  ls -l 
  232  cd graylog/
  233  ls -l 
  234  nano stack.yaml 
  235  cd ..
  236  ls -l 
  237  mkdir wordpress
  238  cd wordpress/
  239  nano stack.yaml 
  240  history | grep network 
  241  cd ..
  242  ls -l 
  243  cd elasticsearch/
  244  ls -l 
  245  cd ..
  246  ls -l 
  247  cd traefik/
  248  ls -l 
  249  cd ..
  250  git put 
  251  git pushh 
  252  git push
  253  docker services
  254  docker service ls 
  255  docker service ls 
  256  docker service ls 
  257  docker service ls 
  258  docker service ls 
  259  docker service ls 
  260  docker service ls 
  261  docker service ls 
  262  docker service ls 
  263  docker service ls 
  264  docker service ls 
  265  docker service ls 
  266  docker service ls 
  267  docker service ls 
  268  docker service ls 
  269  docker service ls 
  270  docker service 
  271  docker service scale 
  272  docker service scale wp_wordpress 28 
  273  docker service scale wp_wordpress  
  274  docker service scale wp_wordpress=28  
  275  ls -l 
  276  cd ..
  277  ls -l 
  278  cd ..
  279  ls -l 
  280  cd st
  281  docker service ls 
  282  history 
  283  cd /srv
  284  ls -l 
  285  cd co
  286  cd docker/
  287  ls -l 
  288  cd stacks/
  289  ls -l 
  290  history | grep git 
  291  cd ..
  292  git clone https://github.com/nik0chan/cluster-swarm.git
  293  cd cluster-swarm/
  294  ls -l 
  295  ls ../
  296  rsync 
  297  apt-get install -y rsync 
  298  rsync -avz ../stacks/ . 
  299  ls -l 
  300  git add 
  301  git add  . 
  302  git commit "Subida inicia" 
  303  git commit -am "Subida inicia" 
  304  git push 
  305  history 
  306  history  > history.txt 
